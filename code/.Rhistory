aldex.le.ns.clr.all$diff.btw[abs(aldex.le.ns.clr.all$effect) > 1 & aldex.le.ns.clr.all$we.eBH <0.01],
pch = 21, col = rgb(0,0,1,0.5), cex = 0.5)
abline(h = 0, col = rgb(0,0,1,0.5), lty = 2)
# panel B: aldex2 w/ default scale model (gamma = 0.5)
aldex.plot(aldex.le.g.clr.all, type = "MW", cutoff.pval = 0.01, xlim = c(0.325,9),
ylab = "")
title("B)  ALDEx2 - scaled (gamma = 0.5, ~3% difference)", adj = 0, line = 0.8)
points(aldex.le.g.clr.all$diff.win[path.hk],
aldex.le.g.clr.all$diff.btw[path.hk],
pch = 19, col = rgb(1,0.7,0), cex = 0.5)
points(aldex.le.g.clr.all$diff.win[abs(aldex.le.g.clr.all$effect) > 1 & aldex.le.g.clr.all$we.eBH <0.01],
aldex.le.g.clr.all$diff.btw[abs(aldex.le.g.clr.all$effect) > 1 & aldex.le.g.clr.all$we.eBH <0.01],
pch = 21, col = rgb(0,0,1,0.5), cex = 0.5)
abline(h = 0, col = rgb(0,0,1,0.5), lty = 2)
# panel C: aldex2 w/ full scale model (gamma = 0.5, scale difference of 15%)
aldex.plot(aldex.le.s.clr.all, type = "MW", cutoff.pval = 0.01, xlim = c(0.325,9),
ylab = "")
title("C)  ALDEx2 - scaled (gamma = 0.5, 15% difference)", adj = 0, line = 0.8)
points(aldex.le.s.clr.all$diff.win[path.hk],
aldex.le.s.clr.all$diff.btw[path.hk],
pch = 19, col = rgb(1,0.7,0), cex = 0.5)
points(aldex.le.s.clr.all$diff.win[abs(aldex.le.s.clr.all$effect) > 1 & aldex.le.s.clr.all$we.eBH <0.01],
aldex.le.s.clr.all$diff.btw[abs(aldex.le.s.clr.all$effect) > 1 & aldex.le.s.clr.all$we.eBH <0.01],
pch = 21, col = rgb(0,0,1,0.5), cex = 0.5)
abline(h = 0, col = rgb(0,0,1,0.5), lty = 2)
dev.off()
png("~/testlol.png",
units = "in", height = 6, width = 6, res = 400)
par(mfrow= c(1,3))
# panel A: unscaled aldex2
aldex.plot(aldex.le.ns.clr.all, type = "MW", cutoff.pval = 0.01, xlim = c(0.325,9))
title("A)  ALDEx2 unscaled - (gamma = 0, ~3% difference)", adj = 0, line = 0.8)
points(aldex.le.ns.clr.all$diff.win[path.hk],
aldex.le.ns.clr.all$diff.btw[path.hk],
pch = 19, col = rgb(1,0.7,0), cex = 0.5)
points(aldex.le.ns.clr.all$diff.win[abs(aldex.le.ns.clr.all$effect) > 1 & aldex.le.ns.clr.all$we.eBH <0.01],
aldex.le.ns.clr.all$diff.btw[abs(aldex.le.ns.clr.all$effect) > 1 & aldex.le.ns.clr.all$we.eBH <0.01],
pch = 21, col = rgb(0,0,1,0.5), cex = 0.5)
abline(h = 0, col = rgb(0,0,1,0.5), lty = 2)
# panel B: aldex2 w/ default scale model (gamma = 0.5)
aldex.plot(aldex.le.g.clr.all, type = "MW", cutoff.pval = 0.01, xlim = c(0.325,9),
ylab = "")
title("B)  ALDEx2 - scaled (gamma = 0.5, ~3% difference)", adj = 0, line = 0.8)
points(aldex.le.g.clr.all$diff.win[path.hk],
aldex.le.g.clr.all$diff.btw[path.hk],
pch = 19, col = rgb(1,0.7,0), cex = 0.5)
points(aldex.le.g.clr.all$diff.win[abs(aldex.le.g.clr.all$effect) > 1 & aldex.le.g.clr.all$we.eBH <0.01],
aldex.le.g.clr.all$diff.btw[abs(aldex.le.g.clr.all$effect) > 1 & aldex.le.g.clr.all$we.eBH <0.01],
pch = 21, col = rgb(0,0,1,0.5), cex = 0.5)
abline(h = 0, col = rgb(0,0,1,0.5), lty = 2)
# panel C: aldex2 w/ full scale model (gamma = 0.5, scale difference of 15%)
aldex.plot(aldex.le.s.clr.all, type = "MW", cutoff.pval = 0.01, xlim = c(0.325,9),
ylab = "")
title("C)  ALDEx2 - scaled (gamma = 0.5, 15% difference)", adj = 0, line = 0.8)
points(aldex.le.s.clr.all$diff.win[path.hk],
aldex.le.s.clr.all$diff.btw[path.hk],
pch = 19, col = rgb(1,0.7,0), cex = 0.5)
points(aldex.le.s.clr.all$diff.win[abs(aldex.le.s.clr.all$effect) > 1 & aldex.le.s.clr.all$we.eBH <0.01],
aldex.le.s.clr.all$diff.btw[abs(aldex.le.s.clr.all$effect) > 1 & aldex.le.s.clr.all$we.eBH <0.01],
pch = 21, col = rgb(0,0,1,0.5), cex = 0.5)
abline(h = 0, col = rgb(0,0,1,0.5), lty = 2)
dev.off()
png("~/testlol.png",
units = "in", height = 4, width = 12, res = 400)
par(mfrow= c(1,3))
# panel A: unscaled aldex2
aldex.plot(aldex.le.ns.clr.all, type = "MW", cutoff.pval = 0.01, xlim = c(0.325,9))
title("A)  ALDEx2 unscaled - (gamma = 0, ~3% difference)", adj = 0, line = 0.8)
points(aldex.le.ns.clr.all$diff.win[path.hk],
aldex.le.ns.clr.all$diff.btw[path.hk],
pch = 19, col = rgb(1,0.7,0), cex = 0.5)
points(aldex.le.ns.clr.all$diff.win[abs(aldex.le.ns.clr.all$effect) > 1 & aldex.le.ns.clr.all$we.eBH <0.01],
aldex.le.ns.clr.all$diff.btw[abs(aldex.le.ns.clr.all$effect) > 1 & aldex.le.ns.clr.all$we.eBH <0.01],
pch = 21, col = rgb(0,0,1,0.5), cex = 0.5)
abline(h = 0, col = rgb(0,0,1,0.5), lty = 2)
# panel B: aldex2 w/ default scale model (gamma = 0.5)
aldex.plot(aldex.le.g.clr.all, type = "MW", cutoff.pval = 0.01, xlim = c(0.325,9),
ylab = "")
title("B)  ALDEx2 - scaled (gamma = 0.5, ~3% difference)", adj = 0, line = 0.8)
points(aldex.le.g.clr.all$diff.win[path.hk],
aldex.le.g.clr.all$diff.btw[path.hk],
pch = 19, col = rgb(1,0.7,0), cex = 0.5)
points(aldex.le.g.clr.all$diff.win[abs(aldex.le.g.clr.all$effect) > 1 & aldex.le.g.clr.all$we.eBH <0.01],
aldex.le.g.clr.all$diff.btw[abs(aldex.le.g.clr.all$effect) > 1 & aldex.le.g.clr.all$we.eBH <0.01],
pch = 21, col = rgb(0,0,1,0.5), cex = 0.5)
abline(h = 0, col = rgb(0,0,1,0.5), lty = 2)
# panel C: aldex2 w/ full scale model (gamma = 0.5, scale difference of 15%)
aldex.plot(aldex.le.s.clr.all, type = "MW", cutoff.pval = 0.01, xlim = c(0.325,9),
ylab = "")
title("C)  ALDEx2 - scaled (gamma = 0.5, 15% difference)", adj = 0, line = 0.8)
points(aldex.le.s.clr.all$diff.win[path.hk],
aldex.le.s.clr.all$diff.btw[path.hk],
pch = 19, col = rgb(1,0.7,0), cex = 0.5)
points(aldex.le.s.clr.all$diff.win[abs(aldex.le.s.clr.all$effect) > 1 & aldex.le.s.clr.all$we.eBH <0.01],
aldex.le.s.clr.all$diff.btw[abs(aldex.le.s.clr.all$effect) > 1 & aldex.le.s.clr.all$we.eBH <0.01],
pch = 21, col = rgb(0,0,1,0.5), cex = 0.5)
abline(h = 0, col = rgb(0,0,1,0.5), lty = 2)
dev.off()
png("~/testlol.png",
units = "in", height = 5, width = 12, res = 400)
par(mfrow= c(1,3))
# panel A: unscaled aldex2
aldex.plot(aldex.le.ns.clr.all, type = "MW", cutoff.pval = 0.01, xlim = c(0.325,9))
title("A)  ALDEx2 unscaled - (gamma = 0, ~3% difference)", adj = 0, line = 0.8)
points(aldex.le.ns.clr.all$diff.win[path.hk],
aldex.le.ns.clr.all$diff.btw[path.hk],
pch = 19, col = rgb(1,0.7,0), cex = 0.5)
points(aldex.le.ns.clr.all$diff.win[abs(aldex.le.ns.clr.all$effect) > 1 & aldex.le.ns.clr.all$we.eBH <0.01],
aldex.le.ns.clr.all$diff.btw[abs(aldex.le.ns.clr.all$effect) > 1 & aldex.le.ns.clr.all$we.eBH <0.01],
pch = 21, col = rgb(0,0,1,0.5), cex = 0.5)
abline(h = 0, col = rgb(0,0,1,0.5), lty = 2)
# panel B: aldex2 w/ default scale model (gamma = 0.5)
aldex.plot(aldex.le.g.clr.all, type = "MW", cutoff.pval = 0.01, xlim = c(0.325,9),
ylab = "")
title("B)  ALDEx2 - scaled (gamma = 0.5, ~3% difference)", adj = 0, line = 0.8)
points(aldex.le.g.clr.all$diff.win[path.hk],
aldex.le.g.clr.all$diff.btw[path.hk],
pch = 19, col = rgb(1,0.7,0), cex = 0.5)
points(aldex.le.g.clr.all$diff.win[abs(aldex.le.g.clr.all$effect) > 1 & aldex.le.g.clr.all$we.eBH <0.01],
aldex.le.g.clr.all$diff.btw[abs(aldex.le.g.clr.all$effect) > 1 & aldex.le.g.clr.all$we.eBH <0.01],
pch = 21, col = rgb(0,0,1,0.5), cex = 0.5)
abline(h = 0, col = rgb(0,0,1,0.5), lty = 2)
# panel C: aldex2 w/ full scale model (gamma = 0.5, scale difference of 15%)
aldex.plot(aldex.le.s.clr.all, type = "MW", cutoff.pval = 0.01, xlim = c(0.325,9),
ylab = "")
title("C)  ALDEx2 - scaled (gamma = 0.5, 15% difference)", adj = 0, line = 0.8)
points(aldex.le.s.clr.all$diff.win[path.hk],
aldex.le.s.clr.all$diff.btw[path.hk],
pch = 19, col = rgb(1,0.7,0), cex = 0.5)
points(aldex.le.s.clr.all$diff.win[abs(aldex.le.s.clr.all$effect) > 1 & aldex.le.s.clr.all$we.eBH <0.01],
aldex.le.s.clr.all$diff.btw[abs(aldex.le.s.clr.all$effect) > 1 & aldex.le.s.clr.all$we.eBH <0.01],
pch = 21, col = rgb(0,0,1,0.5), cex = 0.5)
abline(h = 0, col = rgb(0,0,1,0.5), lty = 2)
dev.off()
png("~/testlol.png",
units = "in", height = 6, width = 12, res = 400)
par(mfrow= c(1,3))
# panel A: unscaled aldex2
aldex.plot(aldex.le.ns.clr.all, type = "MW", cutoff.pval = 0.01, xlim = c(0.325,9))
title("A)  ALDEx2 unscaled - (gamma = 0, ~3% difference)", adj = 0, line = 0.8)
points(aldex.le.ns.clr.all$diff.win[path.hk],
aldex.le.ns.clr.all$diff.btw[path.hk],
pch = 19, col = rgb(1,0.7,0), cex = 0.5)
points(aldex.le.ns.clr.all$diff.win[abs(aldex.le.ns.clr.all$effect) > 1 & aldex.le.ns.clr.all$we.eBH <0.01],
aldex.le.ns.clr.all$diff.btw[abs(aldex.le.ns.clr.all$effect) > 1 & aldex.le.ns.clr.all$we.eBH <0.01],
pch = 21, col = rgb(0,0,1,0.5), cex = 0.5)
abline(h = 0, col = rgb(0,0,1,0.5), lty = 2)
# panel B: aldex2 w/ default scale model (gamma = 0.5)
aldex.plot(aldex.le.g.clr.all, type = "MW", cutoff.pval = 0.01, xlim = c(0.325,9),
ylab = "")
title("B)  ALDEx2 - scaled (gamma = 0.5, ~3% difference)", adj = 0, line = 0.8)
points(aldex.le.g.clr.all$diff.win[path.hk],
aldex.le.g.clr.all$diff.btw[path.hk],
pch = 19, col = rgb(1,0.7,0), cex = 0.5)
points(aldex.le.g.clr.all$diff.win[abs(aldex.le.g.clr.all$effect) > 1 & aldex.le.g.clr.all$we.eBH <0.01],
aldex.le.g.clr.all$diff.btw[abs(aldex.le.g.clr.all$effect) > 1 & aldex.le.g.clr.all$we.eBH <0.01],
pch = 21, col = rgb(0,0,1,0.5), cex = 0.5)
abline(h = 0, col = rgb(0,0,1,0.5), lty = 2)
# panel C: aldex2 w/ full scale model (gamma = 0.5, scale difference of 15%)
aldex.plot(aldex.le.s.clr.all, type = "MW", cutoff.pval = 0.01, xlim = c(0.325,9),
ylab = "")
title("C)  ALDEx2 - scaled (gamma = 0.5, 15% difference)", adj = 0, line = 0.8)
points(aldex.le.s.clr.all$diff.win[path.hk],
aldex.le.s.clr.all$diff.btw[path.hk],
pch = 19, col = rgb(1,0.7,0), cex = 0.5)
points(aldex.le.s.clr.all$diff.win[abs(aldex.le.s.clr.all$effect) > 1 & aldex.le.s.clr.all$we.eBH <0.01],
aldex.le.s.clr.all$diff.btw[abs(aldex.le.s.clr.all$effect) > 1 & aldex.le.s.clr.all$we.eBH <0.01],
pch = 21, col = rgb(0,0,1,0.5), cex = 0.5)
abline(h = 0, col = rgb(0,0,1,0.5), lty = 2)
dev.off()
png("~/testlol.png",
units = "in", height = 6, width = 12, res = 600)
par(mfrow= c(1,3))
# panel A: unscaled aldex2
aldex.plot(aldex.le.ns.clr.all, type = "MW", cutoff.pval = 0.01, xlim = c(0.325,9))
title("A)  ALDEx2 unscaled - (gamma = 0, ~3% difference)", adj = 0, line = 0.8)
points(aldex.le.ns.clr.all$diff.win[path.hk],
aldex.le.ns.clr.all$diff.btw[path.hk],
pch = 19, col = rgb(1,0.7,0), cex = 0.5)
points(aldex.le.ns.clr.all$diff.win[abs(aldex.le.ns.clr.all$effect) > 1 & aldex.le.ns.clr.all$we.eBH <0.01],
aldex.le.ns.clr.all$diff.btw[abs(aldex.le.ns.clr.all$effect) > 1 & aldex.le.ns.clr.all$we.eBH <0.01],
pch = 21, col = rgb(0,0,1,0.5), cex = 0.5)
abline(h = 0, col = rgb(0,0,1,0.5), lty = 2)
# panel B: aldex2 w/ default scale model (gamma = 0.5)
aldex.plot(aldex.le.g.clr.all, type = "MW", cutoff.pval = 0.01, xlim = c(0.325,9),
ylab = "")
title("B)  ALDEx2 - scaled (gamma = 0.5, ~3% difference)", adj = 0, line = 0.8)
points(aldex.le.g.clr.all$diff.win[path.hk],
aldex.le.g.clr.all$diff.btw[path.hk],
pch = 19, col = rgb(1,0.7,0), cex = 0.5)
points(aldex.le.g.clr.all$diff.win[abs(aldex.le.g.clr.all$effect) > 1 & aldex.le.g.clr.all$we.eBH <0.01],
aldex.le.g.clr.all$diff.btw[abs(aldex.le.g.clr.all$effect) > 1 & aldex.le.g.clr.all$we.eBH <0.01],
pch = 21, col = rgb(0,0,1,0.5), cex = 0.5)
abline(h = 0, col = rgb(0,0,1,0.5), lty = 2)
# panel C: aldex2 w/ full scale model (gamma = 0.5, scale difference of 15%)
aldex.plot(aldex.le.s.clr.all, type = "MW", cutoff.pval = 0.01, xlim = c(0.325,9),
ylab = "")
title("C)  ALDEx2 - scaled (gamma = 0.5, 15% difference)", adj = 0, line = 0.8)
points(aldex.le.s.clr.all$diff.win[path.hk],
aldex.le.s.clr.all$diff.btw[path.hk],
pch = 19, col = rgb(1,0.7,0), cex = 0.5)
points(aldex.le.s.clr.all$diff.win[abs(aldex.le.s.clr.all$effect) > 1 & aldex.le.s.clr.all$we.eBH <0.01],
aldex.le.s.clr.all$diff.btw[abs(aldex.le.s.clr.all$effect) > 1 & aldex.le.s.clr.all$we.eBH <0.01],
pch = 21, col = rgb(0,0,1,0.5), cex = 0.5)
abline(h = 0, col = rgb(0,0,1,0.5), lty = 2)
dev.off()
png(paste0(path.to.github,"figs_for_paper/R_FigsLondonEurope/suppl_lon_eur_scaleMWs.png"),
units = "in", height = 6, width = 12, res = 600)
par(mfrow= c(1,3))
# panel A: unscaled aldex2
aldex.plot(aldex.le.ns.clr.all, type = "MW", cutoff.pval = 0.01, xlim = c(0.325,9))
title("A)  ALDEx2 unscaled - (gamma = 0, ~3% difference)", adj = 0, line = 0.8)
points(aldex.le.ns.clr.all$diff.win[path.hk],
aldex.le.ns.clr.all$diff.btw[path.hk],
pch = 19, col = rgb(1,0.7,0), cex = 0.5)
points(aldex.le.ns.clr.all$diff.win[abs(aldex.le.ns.clr.all$effect) > 1 & aldex.le.ns.clr.all$we.eBH <0.01],
aldex.le.ns.clr.all$diff.btw[abs(aldex.le.ns.clr.all$effect) > 1 & aldex.le.ns.clr.all$we.eBH <0.01],
pch = 21, col = rgb(0,0,1,0.5), cex = 0.5)
abline(h = 0, col = rgb(0,0,1,0.5), lty = 2)
# panel B: aldex2 w/ default scale model (gamma = 0.5)
aldex.plot(aldex.le.g.clr.all, type = "MW", cutoff.pval = 0.01, xlim = c(0.325,9),
ylab = "")
title("B)  ALDEx2 - scaled (gamma = 0.5, ~3% difference)", adj = 0, line = 0.8)
points(aldex.le.g.clr.all$diff.win[path.hk],
aldex.le.g.clr.all$diff.btw[path.hk],
pch = 19, col = rgb(1,0.7,0), cex = 0.5)
points(aldex.le.g.clr.all$diff.win[abs(aldex.le.g.clr.all$effect) > 1 & aldex.le.g.clr.all$we.eBH <0.01],
aldex.le.g.clr.all$diff.btw[abs(aldex.le.g.clr.all$effect) > 1 & aldex.le.g.clr.all$we.eBH <0.01],
pch = 21, col = rgb(0,0,1,0.5), cex = 0.5)
abline(h = 0, col = rgb(0,0,1,0.5), lty = 2)
# panel C: aldex2 w/ full scale model (gamma = 0.5, scale difference of 15%)
aldex.plot(aldex.le.s.clr.all, type = "MW", cutoff.pval = 0.01, xlim = c(0.325,9),
ylab = "")
title("C)  ALDEx2 - scaled (gamma = 0.5, 15% difference)", adj = 0, line = 0.8)
points(aldex.le.s.clr.all$diff.win[path.hk],
aldex.le.s.clr.all$diff.btw[path.hk],
pch = 19, col = rgb(1,0.7,0), cex = 0.5)
points(aldex.le.s.clr.all$diff.win[abs(aldex.le.s.clr.all$effect) > 1 & aldex.le.s.clr.all$we.eBH <0.01],
aldex.le.s.clr.all$diff.btw[abs(aldex.le.s.clr.all$effect) > 1 & aldex.le.s.clr.all$we.eBH <0.01],
pch = 21, col = rgb(0,0,1,0.5), cex = 0.5)
abline(h = 0, col = rgb(0,0,1,0.5), lty = 2)
dev.off()
png(paste0(path.to.github,"figs_for_paper/R_FigsLondonEurope/suppl_lon_eur_scaleMWs.png"),
units = "in", height = 6, width = 10, res = 600)
par(mfrow= c(1,3))
# panel A: unscaled aldex2
aldex.plot(aldex.le.ns.clr.all, type = "MW", cutoff.pval = 0.01, xlim = c(0.325,9))
title("A)  ALDEx2 unscaled - (gamma = 0, ~3% difference)", adj = 0, line = 0.8)
points(aldex.le.ns.clr.all$diff.win[path.hk],
aldex.le.ns.clr.all$diff.btw[path.hk],
pch = 19, col = rgb(1,0.7,0), cex = 0.5)
points(aldex.le.ns.clr.all$diff.win[abs(aldex.le.ns.clr.all$effect) > 1 & aldex.le.ns.clr.all$we.eBH <0.01],
aldex.le.ns.clr.all$diff.btw[abs(aldex.le.ns.clr.all$effect) > 1 & aldex.le.ns.clr.all$we.eBH <0.01],
pch = 21, col = rgb(0,0,1,0.5), cex = 0.5)
abline(h = 0, col = rgb(0,0,1,0.5), lty = 2)
# panel B: aldex2 w/ default scale model (gamma = 0.5)
aldex.plot(aldex.le.g.clr.all, type = "MW", cutoff.pval = 0.01, xlim = c(0.325,9),
ylab = "")
title("B)  ALDEx2 - scaled (gamma = 0.5, ~3% difference)", adj = 0, line = 0.8)
points(aldex.le.g.clr.all$diff.win[path.hk],
aldex.le.g.clr.all$diff.btw[path.hk],
pch = 19, col = rgb(1,0.7,0), cex = 0.5)
points(aldex.le.g.clr.all$diff.win[abs(aldex.le.g.clr.all$effect) > 1 & aldex.le.g.clr.all$we.eBH <0.01],
aldex.le.g.clr.all$diff.btw[abs(aldex.le.g.clr.all$effect) > 1 & aldex.le.g.clr.all$we.eBH <0.01],
pch = 21, col = rgb(0,0,1,0.5), cex = 0.5)
abline(h = 0, col = rgb(0,0,1,0.5), lty = 2)
# panel C: aldex2 w/ full scale model (gamma = 0.5, scale difference of 15%)
aldex.plot(aldex.le.s.clr.all, type = "MW", cutoff.pval = 0.01, xlim = c(0.325,9),
ylab = "")
title("C)  ALDEx2 - scaled (gamma = 0.5, 15% difference)", adj = 0, line = 0.8)
points(aldex.le.s.clr.all$diff.win[path.hk],
aldex.le.s.clr.all$diff.btw[path.hk],
pch = 19, col = rgb(1,0.7,0), cex = 0.5)
points(aldex.le.s.clr.all$diff.win[abs(aldex.le.s.clr.all$effect) > 1 & aldex.le.s.clr.all$we.eBH <0.01],
aldex.le.s.clr.all$diff.btw[abs(aldex.le.s.clr.all$effect) > 1 & aldex.le.s.clr.all$we.eBH <0.01],
pch = 21, col = rgb(0,0,1,0.5), cex = 0.5)
abline(h = 0, col = rgb(0,0,1,0.5), lty = 2)
dev.off()
png(paste0(path.to.github,"figs_for_paper/R_FigsLondonEurope/suppl_lon_eur_scaleMWs.png"),
units = "in", height = 6, width = 12, res = 600)
par(mfrow= c(1,3))
# panel A: unscaled aldex2
aldex.plot(aldex.le.ns.clr.all, type = "MW", cutoff.pval = 0.01, xlim = c(0.325,9))
title("A)  ALDEx2 unscaled - (gamma = 0, ~3% difference)", adj = 0, line = 0.8)
points(aldex.le.ns.clr.all$diff.win[path.hk],
aldex.le.ns.clr.all$diff.btw[path.hk],
pch = 19, col = rgb(1,0.7,0), cex = 0.5)
points(aldex.le.ns.clr.all$diff.win[abs(aldex.le.ns.clr.all$effect) > 1 & aldex.le.ns.clr.all$we.eBH <0.01],
aldex.le.ns.clr.all$diff.btw[abs(aldex.le.ns.clr.all$effect) > 1 & aldex.le.ns.clr.all$we.eBH <0.01],
pch = 21, col = rgb(0,0,1,0.5), cex = 0.5)
abline(h = 0, col = rgb(0,0,1,0.5), lty = 2)
# panel B: aldex2 w/ default scale model (gamma = 0.5)
aldex.plot(aldex.le.g.clr.all, type = "MW", cutoff.pval = 0.01, xlim = c(0.325,9),
ylab = "")
title("B)  ALDEx2 - scaled (gamma = 0.5, ~3% difference)", adj = 0, line = 0.8)
points(aldex.le.g.clr.all$diff.win[path.hk],
aldex.le.g.clr.all$diff.btw[path.hk],
pch = 19, col = rgb(1,0.7,0), cex = 0.5)
points(aldex.le.g.clr.all$diff.win[abs(aldex.le.g.clr.all$effect) > 1 & aldex.le.g.clr.all$we.eBH <0.01],
aldex.le.g.clr.all$diff.btw[abs(aldex.le.g.clr.all$effect) > 1 & aldex.le.g.clr.all$we.eBH <0.01],
pch = 21, col = rgb(0,0,1,0.5), cex = 0.5)
abline(h = 0, col = rgb(0,0,1,0.5), lty = 2)
# panel C: aldex2 w/ full scale model (gamma = 0.5, scale difference of 15%)
aldex.plot(aldex.le.s.clr.all, type = "MW", cutoff.pval = 0.01, xlim = c(0.325,9),
ylab = "")
title("C)  ALDEx2 - scaled (gamma = 0.5, 15% difference)", adj = 0, line = 0.8)
points(aldex.le.s.clr.all$diff.win[path.hk],
aldex.le.s.clr.all$diff.btw[path.hk],
pch = 19, col = rgb(1,0.7,0), cex = 0.5)
points(aldex.le.s.clr.all$diff.win[abs(aldex.le.s.clr.all$effect) > 1 & aldex.le.s.clr.all$we.eBH <0.01],
aldex.le.s.clr.all$diff.btw[abs(aldex.le.s.clr.all$effect) > 1 & aldex.le.s.clr.all$we.eBH <0.01],
pch = 21, col = rgb(0,0,1,0.5), cex = 0.5)
abline(h = 0, col = rgb(0,0,1,0.5), lty = 2)
dev.off()
png(paste0(path.to.github,"figs_for_paper/R_FigsLondonEurope/suppl_lon_eur_scaleMWs.png"),
units = "in", height = 5, width = 12, res = 600)
par(mfrow= c(1,3))
# panel A: unscaled aldex2
aldex.plot(aldex.le.ns.clr.all, type = "MW", cutoff.pval = 0.01, xlim = c(0.325,9))
title("A)  ALDEx2 unscaled - (gamma = 0, ~3% difference)", adj = 0, line = 0.8)
points(aldex.le.ns.clr.all$diff.win[path.hk],
aldex.le.ns.clr.all$diff.btw[path.hk],
pch = 19, col = rgb(1,0.7,0), cex = 0.5)
points(aldex.le.ns.clr.all$diff.win[abs(aldex.le.ns.clr.all$effect) > 1 & aldex.le.ns.clr.all$we.eBH <0.01],
aldex.le.ns.clr.all$diff.btw[abs(aldex.le.ns.clr.all$effect) > 1 & aldex.le.ns.clr.all$we.eBH <0.01],
pch = 21, col = rgb(0,0,1,0.5), cex = 0.5)
abline(h = 0, col = rgb(0,0,1,0.5), lty = 2)
# panel B: aldex2 w/ default scale model (gamma = 0.5)
aldex.plot(aldex.le.g.clr.all, type = "MW", cutoff.pval = 0.01, xlim = c(0.325,9),
ylab = "")
title("B)  ALDEx2 - scaled (gamma = 0.5, ~3% difference)", adj = 0, line = 0.8)
points(aldex.le.g.clr.all$diff.win[path.hk],
aldex.le.g.clr.all$diff.btw[path.hk],
pch = 19, col = rgb(1,0.7,0), cex = 0.5)
points(aldex.le.g.clr.all$diff.win[abs(aldex.le.g.clr.all$effect) > 1 & aldex.le.g.clr.all$we.eBH <0.01],
aldex.le.g.clr.all$diff.btw[abs(aldex.le.g.clr.all$effect) > 1 & aldex.le.g.clr.all$we.eBH <0.01],
pch = 21, col = rgb(0,0,1,0.5), cex = 0.5)
abline(h = 0, col = rgb(0,0,1,0.5), lty = 2)
# panel C: aldex2 w/ full scale model (gamma = 0.5, scale difference of 15%)
aldex.plot(aldex.le.s.clr.all, type = "MW", cutoff.pval = 0.01, xlim = c(0.325,9),
ylab = "")
title("C)  ALDEx2 - scaled (gamma = 0.5, 15% difference)", adj = 0, line = 0.8)
points(aldex.le.s.clr.all$diff.win[path.hk],
aldex.le.s.clr.all$diff.btw[path.hk],
pch = 19, col = rgb(1,0.7,0), cex = 0.5)
points(aldex.le.s.clr.all$diff.win[abs(aldex.le.s.clr.all$effect) > 1 & aldex.le.s.clr.all$we.eBH <0.01],
aldex.le.s.clr.all$diff.btw[abs(aldex.le.s.clr.all$effect) > 1 & aldex.le.s.clr.all$we.eBH <0.01],
pch = 21, col = rgb(0,0,1,0.5), cex = 0.5)
abline(h = 0, col = rgb(0,0,1,0.5), lty = 2)
dev.off()
png(paste0(path.to.github,"figs_for_paper/R_FigsLondonEurope/suppl_lon_eur_scaleMWs.png"),
units = "in", height = 6, width = 12, res = 600)
par(mfrow= c(1,3))
# panel A: unscaled aldex2
aldex.plot(aldex.le.ns.clr.all, type = "MW", cutoff.pval = 0.01, xlim = c(0.325,9))
title("A)  ALDEx2 unscaled - (gamma = 0, ~3% difference)", adj = 0, line = 0.8)
points(aldex.le.ns.clr.all$diff.win[path.hk],
aldex.le.ns.clr.all$diff.btw[path.hk],
pch = 19, col = rgb(1,0.7,0), cex = 0.5)
points(aldex.le.ns.clr.all$diff.win[abs(aldex.le.ns.clr.all$effect) > 1 & aldex.le.ns.clr.all$we.eBH <0.01],
aldex.le.ns.clr.all$diff.btw[abs(aldex.le.ns.clr.all$effect) > 1 & aldex.le.ns.clr.all$we.eBH <0.01],
pch = 21, col = rgb(0,0,1,0.5), cex = 0.5)
abline(h = 0, col = rgb(0,0,1,0.5), lty = 2)
# panel B: aldex2 w/ default scale model (gamma = 0.5)
aldex.plot(aldex.le.g.clr.all, type = "MW", cutoff.pval = 0.01, xlim = c(0.325,9),
ylab = "")
title("B)  ALDEx2 - scaled (gamma = 0.5, ~3% difference)", adj = 0, line = 0.8)
points(aldex.le.g.clr.all$diff.win[path.hk],
aldex.le.g.clr.all$diff.btw[path.hk],
pch = 19, col = rgb(1,0.7,0), cex = 0.5)
points(aldex.le.g.clr.all$diff.win[abs(aldex.le.g.clr.all$effect) > 1 & aldex.le.g.clr.all$we.eBH <0.01],
aldex.le.g.clr.all$diff.btw[abs(aldex.le.g.clr.all$effect) > 1 & aldex.le.g.clr.all$we.eBH <0.01],
pch = 21, col = rgb(0,0,1,0.5), cex = 0.5)
abline(h = 0, col = rgb(0,0,1,0.5), lty = 2)
# panel C: aldex2 w/ full scale model (gamma = 0.5, scale difference of 15%)
aldex.plot(aldex.le.s.clr.all, type = "MW", cutoff.pval = 0.01, xlim = c(0.325,9),
ylab = "")
title("C)  ALDEx2 - scaled (gamma = 0.5, 15% difference)", adj = 0, line = 0.8)
points(aldex.le.s.clr.all$diff.win[path.hk],
aldex.le.s.clr.all$diff.btw[path.hk],
pch = 19, col = rgb(1,0.7,0), cex = 0.5)
points(aldex.le.s.clr.all$diff.win[abs(aldex.le.s.clr.all$effect) > 1 & aldex.le.s.clr.all$we.eBH <0.01],
aldex.le.s.clr.all$diff.btw[abs(aldex.le.s.clr.all$effect) > 1 & aldex.le.s.clr.all$we.eBH <0.01],
pch = 21, col = rgb(0,0,1,0.5), cex = 0.5)
abline(h = 0, col = rgb(0,0,1,0.5), lty = 2)
dev.off()
# identifying signature pathways for health vs. BV and BV subgroups
#################################### setup ####################################
# install the coda4microbiome package
# install.packages("coda4microbiome")
# BiocManager::install("ComplexHeatmap") # required but not installed above
library(coda4microbiome)
library(ALDEx2)
# path to github
user <- "sds/cc"
path.to.github <- switch(user,
"sds/cc" = "~/Documents/GitHub/metatranscriptome/",
"gg" = "~/Documents/0_git/projects/metatranscriptome/")
# load virginia KO dataset, group info for H/BV and BV1/BV2, lookup tables for
# KO and taxonomy
load(paste0(path.to.github,"Rdata/ko.virginia.filt.Rda"))
load(paste0(path.to.github,"Rdata/virginia.bv.groups.Rda"))
load(paste0(path.to.github,"Rdata/virginia.groups.Rda"))
load(paste0(path.to.github,"Rdata/tax.vec.virginia.Rda"))
load(paste0(path.to.github,"Rdata/virginia.ko.path.filt.Rda"))
# subset dataset for only BV subgroups, transposes and check for zero sum rows
ko.virginia.filt.bv <- ko.virginia.filt[,rownames(virginia.bv.groups)]
any(rowSums(ko.virginia.filt.bv)==0) # returns FALSE
# define group conds
conds.h.bv <- factor(virginia.groups$groups.2)
conds.bv1.bv2 <- factor(virginia.bv.groups$group)
################################ signature KOs ################################
# TAKES AGES DO NOT RUN ------------------------------------------
# # look for microbial signatures by KO number
#
# # health vs. BV
# sigs.ko.health.bv <- coda_glmnet(x = t(ko.virginia.filt), y = conds.h.bv,
#                               showPlots = TRUE)
#
# # BV1 vs. BV2
# sigs.ko.bv.subs <- coda_glmnet(x = t(ko.virginia.filt.bv), y = conds.bv1.bv2,
#                             showPlots = TRUE)
# TAKES AGES DO NOT RUN ------------------------------------------
######################## signature functions: H vs. BV ########################
# aggregate tables by functions present in pathway lookup table and set row
# names
func.h.bv <- aggregate(ko.virginia.filt,
by = list(virginia.ko.path.filt$pathway), FUN = sum)
rownames(func.h.bv) <- func.h.bv$Group.1
func.h.bv$Group.1 <- NULL
clr.h.bv <- aldex.clr(reads = func.h.bv, conds = as.character(conds.h.bv),
mc.samples = 128, denom = "lvha")
# get median CLR values for all pathways & samples
clr.h.bv.effect <- aldex.effect(clr = clr.h.bv, verbose = TRUE,
include.sample.summary = TRUE)
# pull only CLR values into new dataframe
clr.h.bv.effect.df <- as.data.frame(clr.h.bv.effect[,grep("rab.sample.", colnames(clr.h.bv.effect))])
# exponentiate CLR values to get proportions
clr.h.bv.effect.df <- clr.h.bv.effect.df^2
# PCA and biplot of the functional data, centred around housekeeping stuff
pca.h.bv <- prcomp(clr.h.bv.effect.df)
biplot(pca.h.bv, cex = c(0.5,0.1), var.axes = FALSE)
abline(h = 0, v = 0, lty=2, col = "grey")
clr.h.bv.effect.df <- 2^clr.h.bv.effect.df
pca.h.bv <- prcomp(clr.h.bv.effect.df)
biplot(pca.h.bv, cex = c(0.5,0.1), var.axes = FALSE)
abline(h = 0, v = 0, lty=2, col = "grey")
View(clr.h.bv.effect.df)
clr.h.bv <- aldex.clr(reads = func.h.bv, conds = as.character(conds.h.bv),
mc.samples = 128, denom = "lvha", gamma = 0.5)
# get median CLR values for all pathways & samples
clr.h.bv.effect <- aldex.effect(clr = clr.h.bv, verbose = TRUE,
include.sample.summary = TRUE)
# pull only CLR values into new dataframe
clr.h.bv.effect.df <- as.data.frame(clr.h.bv.effect[,grep("rab.sample.", colnames(clr.h.bv.effect))])
# exponentiate CLR values to get proportions
clr.h.bv.effect.df <- 2^clr.h.bv.effect.df
# PCA and biplot of the functional data, centred around housekeeping stuff
pca.h.bv <- prcomp(clr.h.bv.effect.df)
biplot(pca.h.bv, cex = c(0.5,0.1), var.axes = FALSE)
abline(h = 0, v = 0, lty=2, col = "grey")
pca.h.bv <- prcomp(clr.h.bv.effect.df)
biplot(pca.h.bv, cex = c(0.5,0.1), var.axes = FALSE)
abline(h = 0, v = 0, lty=2, col = "grey")
aldex.makeScaleMatrix(gamma = 0.5, mu = c(1,1.15), conditions = conds.h.bv)
set.seed(2024)
scale.h.bv <- aldex.makeScaleMatrix(gamma = 0.5, mu = c(1,1.15),
conditions = conds.h.bv)
clr.h.bv <- aldex.clr(reads = func.h.bv, conds = as.character(conds.h.bv),
mc.samples = 128, denom = "lvha", gamma = scale.h.bv)
clr.h.bv.effect <- aldex.effect(clr = clr.h.bv, verbose = TRUE,
include.sample.summary = TRUE)
# pull only CLR values into new dataframe
clr.h.bv.effect.df <- as.data.frame(clr.h.bv.effect[,grep("rab.sample.", colnames(clr.h.bv.effect))])
# exponentiate CLR values to get proportions
clr.h.bv.effect.df <- 2^clr.h.bv.effect.df
# PCA and biplot of the functional data, centred around housekeeping stuff
pca.h.bv <- prcomp(clr.h.bv.effect.df)
biplot(pca.h.bv, cex = c(0.5,0.1), var.axes = FALSE)
abline(h = 0, v = 0, lty=2, col = "grey")
set.seed(2024)
clr.h.bv <- aldex.clr(reads = func.h.bv, conds = as.character(conds.h.bv),
mc.samples = 128, denom = "lvha")
# get median CLR values for all pathways & samples
clr.h.bv.effect <- aldex.effect(clr = clr.h.bv, verbose = TRUE,
include.sample.summary = TRUE)
# pull only CLR values into new dataframe
clr.h.bv.effect.df <- as.data.frame(clr.h.bv.effect[,grep("rab.sample.", colnames(clr.h.bv.effect))])
# exponentiate CLR values to get proportions
clr.h.bv.effect.df <- 2^clr.h.bv.effect.df
matrix(rep(1:5, 2), byrow = truehist())
matrix(rep(1:5, 2), byrow = TRUE)
matrix(rep(1:5, 2),ncol = 2, byrow = TRUE)
matrix(rep(1:5, 2),ncol = 2, byrow = FALSE)
lol<-matrix(rep(1:5, 2),ncol = 2, byrow = FALSE)
log2(lol)
2^log2(lol)
rm(lol)
set.seed(2024)
clr.h.bv <- aldex.clr(reads = func.h.bv, conds = as.character(conds.h.bv),
mc.samples = 128, denom = "lvha")
# get median CLR values for all pathways & samples
clr.h.bv.effect <- aldex.effect(clr = clr.h.bv, verbose = TRUE,
include.sample.summary = TRUE)
# pull only CLR values into new dataframe
clr.h.bv.effect.df <- as.data.frame(clr.h.bv.effect[,grep("rab.sample.", colnames(clr.h.bv.effect))])
# exponentiate CLR values to undo log2 transform and retrieve proportions
clr.h.bv.effect.df <- 2^clr.h.bv.effect.df
# PCA and biplot of the functional data, centred around housekeeping stuff
pca.h.bv <- prcomp(clr.h.bv.effect.df)
biplot(pca.h.bv, cex = c(0.5,0.1), var.axes = FALSE)
abline(h = 0, v = 0, lty=2, col = "grey")
